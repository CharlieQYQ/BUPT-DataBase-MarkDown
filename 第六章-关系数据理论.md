# 第六章·关系数据理论
> 乔毅
> 2019210472
> 本章讨论关系数据理论

[TOC]

## 6.1 问题的提出
针对一个具体问题，应该如何构造一个适合于它的数据库模式  
这是数据库设计的问题，确切地讲是关系数据库逻辑设计问题  
数据库逻辑设计的一个有力工具——**关系数据库的规范化理论**  
第一范式 1NF
- 每一个分量必须是不可分的数据项
- **数据依赖**是一个关系内部属性与属性之间的一种约束关系
	- 通过属性值的相等与否体现出数据间的相关联系
	- 是现实世界属性的抽象
	- 是数据内在的性质，是语义的体现
- 最重要的是**函数依赖**（Functional Dependency，FD）和**多值依赖**（Multi-Valued Dependency，MVD）
- 函数依赖
	- 属性间的依赖关系类似于数学中的函数$y=f(x)$
	- 自变量x确定后，相应的函数值y也就唯一的确定
- 一个好的模式应当不会发生插入异常、删除异常和更新异常，数据亢余尽可能少


## 6.2 规范化

### 6.2.1 函数依赖
定义：设$R(U)$是属性集U上的关系模式，X，Y是U的子集。若对于$R(U)$的任意一个可能的关系r，r中不可能存在两个元组在X的属性值相等，而在Y上的属性值不等，则称**X函数确定Y**或**Y函数依赖于X**，记作$X→Y$。  
函数依赖和别的数据依赖一样是语义范畴的概念，只能依据语义来确定一个函数依赖  
定义术语和符号
- $X→Y$，但$Y not \subseteq X$，则称X→Y是**非平凡的函数依赖**
- $X→Y$，但$Y\subseteq X$，则称X→Y是**平凡的函数依赖**
- 若X→Y，则X称为这个函数依赖的决定属性组，也称为**决定因素**（determination）
定义：在$R(U)$中，
- 如果X→Y，并且对于X的任何一个真子集X'，都有X'not→Y，则称Y对X**完全函数依赖**，记作$X→^FY$
- 若X→Y，但Y不完全函数依赖于X，则称Y对X**部分函数依赖**，记作$X→^PY$
定义：在$R(U)$中，如果X→Y，Ynot→X，Y→Z，则称Z对X**传递函数依赖**（transitive functional dependency），记作$X→^{传递}Y$

### 6.2.2 码
**码是关系模式中的一个重要概念**
定义：设K为R<U，F>中的属性或属性集合，
- 若$K→^FU$，则K为R的**候选码**（candidate key）
- 若$K→^PU$，则K称为**超码**（Surpkey）[候选码是最小的超码]
- 若候选码多余一个，则选定其中的一个作为**主码**（primary key）
- 包含在任何一个候选码中的属性称为**主属性**（prime attribute）
- 不包含在任何候选码中的属性称为**非主属性**（nonprime attribute）或**非码属性**（non-key attribute）
- 最极端的情况：整个属性组是码，称为**全码**（all-key）

### 6.2.3 范式
关系数据库中的关系是要满足一定要求的，满足不同程度要求的为不同范式  
满足最低要求的叫第一范式，简称1NF  
一个第一级范式的关系模式通过模式分解（schema decomposition）可以转换为若干个高一级范式的关系模式的集合，这种过程就叫**规范化**（normalization）  

### 6.2.4 2NF
定义：若$R\in 1NF$，且每一个非主属性完全函数依赖于任何一个候选码，则$R\in 2NF$

### 6.2.5 3NF
定义：设关系模式$R<U，F>\in 1NF$，若R中不存在这样的码X，属性组Y及非主属性Z，使得X→Y，Y→Z成立，Ynot→X，则称$R<U，F>\in 3NF$  
R属于3NF，则必有R属于2NF  
关系模式中没有传递依赖  

### 6.2.6 BCNF
BCNF（Boyce Codd Normal From）是有Boyce与Codd提出的  
通常认为BCNF是修正的第三范式，有时也称为扩充的第三范式  
定义：关系模式$R<U，F>\in 1NF$，若X→Y且$Ynot\subseteq X$时X必含有码，则$R<U，F>\in BCNF$  
也就是说，关系模式R<U，F>中，若每一个决定因素都包含码，则$R<U，F>\in BCNF$  
一个满足BCNF的关系模式有
- 所有非主属性对每一个码都是完全函数依赖
- 所有主属性对每一个不包含它的码也是完全函数依赖
- 没有任何属性完全函数依赖于非码的任何一组属性

### 6.2.7 多值依赖
定义：设$R(U)$是属性集U上的一个关系模式。X，Y，Z是U的子集，并且Z=U-X-Y。关系模式$R(U)$中**多值依赖**X→→Y成立，当且仅当对$R(U)$的任一关系r，给定的一对（x，z）值，有一组Y的值，这组值仅仅决定于x值而与z值无关  
若X→→Y，而$Z=\emptyset$，即Z为空，则称X→→Y为**平凡的多值依赖**

### 6.2.8 4NF
定义：关系模式$R<U，F>\in 1NF$，如果对于R的每个非凡多值依赖X→→Y，X都含有码，则称$R<U，F>\in 4NF$  
4NF就是限制关系模式的属性之间不允许有非平凡且非函数依赖的多值依赖  
**事实上，4NF允许的非平凡多值依赖实际上是函数依赖**

### 6.2.9 规范化小结
规范化的基本思想是逐步消除数据依赖中不合适的部分  
**“一事一地”的模式设计原则**  
规范化实质上是概念的单一化  
关系模式的规范化过程是通过对关系模式的分解来实现的，即把第一级的关系模式分解为若干个高一级的关系模式

## 6.3 Log
- 2021.5.23 编写完成
- 2021.5.29 上传到[Github](https://github.com/CharlieQYQ/BUPT-DataBase-MarkDown)

